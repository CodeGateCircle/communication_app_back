openapi: "3.0.0"

info:
  version: 1.0.0
  title: communication_app
  description: "communication_appのOpenAPI"

tags:
  - name: workspaces
    description: about workspaces
  - name: categories
    description: about categories
  - name: rooms
    description: about rooms

servers:
  - url: ---
    description: production API
  - url: http://{host}:{port}/api/v0
    description: development
    variables:
      host:
        default: localhost
      port:
        default: '3000'

paths:
  # workspace
  /workspaces:
    post:
      tags:
        - workspaces
      operationId: create_workspace
      summary: Create new workspace.
      description: Create new workspace.
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/workspace_data"

      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  $ref: "#/components/schemas/name"
                description:
                  $ref: "#/components/schemas/description"
                iconImageUrl:
                  $ref: "#/components/schemas/iconImageUrl"
                coverImageUrl:
                  $ref: "#/components/schemas/coverImageUrl"

  /workspaces/{workspace_id}:
    put:
      tags:
        - workspaces
      operationId: update_workspace
      summary: Update the workspace.
      description: Update the workspace
      parameters:
        - name: workspace_id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/workspaceId"
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/workspace_data"

  /workspaces/{workspace_id}/delete:
    post:
      tags:
        - workspaces
      operationId: delete_workspace
      summary: Delete the workspace
      description: Delete the workspace
      parameters:
        - name: workspace_id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/workspaceId"
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                example: { success: true}

  # category
  /categories:
    post:
      tags:
        - categories
      operationId: create_category
      summary: create category
      description: Create category.
      responses:
        200:
          description: Success operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/category"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  $ref: "#/components/schemas/name"
                workspace_id:
                  $ref: "#/components/schemas/workspaceId"

  /categories/{category_id}:
    put:
      tags:
        - categories
      operationId: update_category
      summary: Update the category.
      description: Update the category
      parameters:
        - name: category_id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/categoryId"
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/category"

# TODO: test passed, but the schema of category is string, not object.

  # room
  /rooms:
    post:
      tags:
        - rooms
      operationId: create_room
      summary: Create new room.
      description: Create new room.
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/room_data"

      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  $ref: "#/components/schemas/name"
                description:
                  $ref: "#/components/schemas/description"
                category:
                  $ref: "#/components/schemas/category"
                workspaceId:
                  $ref: "#/components/schemas/workspaceId"




components:
  schemas:
    workspace_data:
      description: explain
      type: object
      required:
        - workspace
      properties:
        workspace:
          description: explain
          type: object
          required:
            - id
            - name
            - description
            - iconImageUrl
            - coverImageUrl
          properties:
            id:
              $ref: "#/components/schemas/workspaceId"
            name:
              $ref: "#/components/schemas/name"
            description:
              $ref: "#/components/schemas/description"
            iconImageUrl:
              $ref: "#/components/schemas/iconImageUrl"
            coverImageUrl:
              $ref: "#/components/schemas/coverImageUrl"

    room_data:
      description: explain
      type: object
      required:
        - room
      properties:
        workspace:
          description: explain
          type: object
          required:
            - id
            - name
            - description
            - category
            - workspaceId
          properties:
            id:
              $ref: "#/components/schemas/roomId"
            name:
              $ref: "#/components/schemas/name"
            description:
              $ref: "#/components/schemas/description"
            category:
              $ref: "#/components/schemas/category"
            workspaceId:
              $ref: "#/components/schemas/workspaceId"

    workspaceId:
      description: workspace unique id
      example: 111
      type: integer

    categoryId:
      description: category unique id
      example: 333
      type: integer

    roomId:
      description: room unique id
      example: 222
      type: integer
    
    name:
      description: name of workspace
      example: Code.Gate?
      type: string

    description:
      description: description of workspace
      example: Code.Gate?の説明
      type: string

    category:
      description: category of room
      example: general
      type: string

    iconImageUrl:
      description: iconImageUrl of workspace
      example: http://icon_image_url
      type: string

    coverImageUrl:
      description: coverImageUrl of workspace
      example: http://cover_image_url
      type: string